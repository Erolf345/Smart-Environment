[
    {
        "id": "7d7b30a8.5bc2b",
        "type": "tab",
        "label": "LED test flow",
        "disabled": false,
        "info": ""
    },
    {
        "id": "740a99d2.b07d1",
        "type": "function",
        "z": "7d7b30a8.5bc2b",
        "name": "startBlink",
        "func": "var BLINKDELAY = 250;\n\nvar light = true;\n\n\nvar blinker = setInterval(blink, BLINKDELAY);\n\nglobal.set(\"blinker\", blinker);\n\nfunction blink () {\n    \n    if (light) {\n        msg.payload = 1;\n        light = false;\n    }\n    \n    else {\n        msg.payload = 0;\n        light = true;\n    }\n    \n    node.send(msg);\n}\n\n\nreturn;",
        "outputs": 1,
        "noerr": 0,
        "x": 360,
        "y": 200,
        "wires": [
            [
                "41b167bc.bbffc"
            ]
        ]
    },
    {
        "id": "73f5f278.0231bc",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "pressme",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 204,
        "y": 200,
        "wires": [
            [
                "740a99d2.b07d1"
            ]
        ]
    },
    {
        "id": "41b167bc.bbffc",
        "type": "rpi-gpio out",
        "z": "7d7b30a8.5bc2b",
        "name": "Simple LED",
        "pin": "11",
        "set": false,
        "level": "0",
        "freq": "1000",
        "out": "pwm",
        "x": 570,
        "y": 360,
        "wires": []
    },
    {
        "id": "cc1b11b1.bebb28",
        "type": "function",
        "z": "7d7b30a8.5bc2b",
        "name": "stopBlink",
        "func": "clearInterval(global.get(\"blinker\"));\n\nmsg.payload = 0;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 360,
        "y": 260,
        "wires": [
            [
                "41b167bc.bbffc"
            ]
        ]
    },
    {
        "id": "5db82a6c.1b547c",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "pressme",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 195,
        "y": 261,
        "wires": [
            [
                "cc1b11b1.bebb28"
            ]
        ]
    },
    {
        "id": "684e2449.974414",
        "type": "rpi-gpio in",
        "z": "7d7b30a8.5bc2b",
        "name": "PIR sensor",
        "pin": "36",
        "intype": "tri",
        "debounce": "25",
        "read": true,
        "x": 180,
        "y": 540,
        "wires": [
            [
                "f60b971f.d72818",
                "41b167bc.bbffc",
                "20d35e60.b0f65a",
                "1e562453.9b452c"
            ]
        ]
    },
    {
        "id": "38a9dec0.2999f2",
        "type": "comment",
        "z": "7d7b30a8.5bc2b",
        "name": "LED control",
        "info": "",
        "x": 190,
        "y": 140,
        "wires": []
    },
    {
        "id": "f60b971f.d72818",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 490,
        "y": 580,
        "wires": []
    },
    {
        "id": "c176f953.9e71b8",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "on",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 190,
        "y": 340,
        "wires": [
            [
                "41b167bc.bbffc"
            ]
        ]
    },
    {
        "id": "97f7256a.4ea5e8",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "off",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 190,
        "y": 380,
        "wires": [
            [
                "41b167bc.bbffc"
            ]
        ]
    },
    {
        "id": "82428d88.c2784",
        "type": "comment",
        "z": "7d7b30a8.5bc2b",
        "name": "PIR check",
        "info": "",
        "x": 180,
        "y": 460,
        "wires": []
    },
    {
        "id": "30e73299.7e539e",
        "type": "function",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "func": "\nreturn [\n    //need to invert for LED (maybe not here)\n    {payload:255 - msg.payload.r},\n    {payload:255 - msg.payload.g},\n    {payload:255 - msg.payload.b}\n];",
        "outputs": 3,
        "noerr": 0,
        "x": 260,
        "y": 820,
        "wires": [
            [
                "b06ef87a.2ecd18"
            ],
            [
                "3532ded.ea45f22"
            ],
            [
                "813aa6c7.4faa58"
            ]
        ]
    },
    {
        "id": "813aa6c7.4faa58",
        "type": "range",
        "z": "7d7b30a8.5bc2b",
        "minin": "0",
        "maxin": "255",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": true,
        "property": "payload",
        "name": "B",
        "x": 470,
        "y": 860,
        "wires": [
            [
                "3a344f73.a341b",
                "843e8dab.baebc"
            ]
        ]
    },
    {
        "id": "3532ded.ea45f22",
        "type": "range",
        "z": "7d7b30a8.5bc2b",
        "minin": "0",
        "maxin": "255",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": true,
        "property": "payload",
        "name": "G",
        "x": 470,
        "y": 820,
        "wires": [
            [
                "3bfc15b3.af5d12",
                "96ad2af9.ebb138"
            ]
        ]
    },
    {
        "id": "b06ef87a.2ecd18",
        "type": "range",
        "z": "7d7b30a8.5bc2b",
        "minin": "0",
        "maxin": "255",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": true,
        "property": "payload",
        "name": "R",
        "x": 470,
        "y": 780,
        "wires": [
            [
                "5f036011.4248c8",
                "43b79720.9de288"
            ]
        ]
    },
    {
        "id": "843e8dab.baebc",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 670,
        "y": 920,
        "wires": []
    },
    {
        "id": "96ad2af9.ebb138",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 830,
        "y": 820,
        "wires": []
    },
    {
        "id": "43b79720.9de288",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 670,
        "y": 740,
        "wires": []
    },
    {
        "id": "3bfc15b3.af5d12",
        "type": "rpi-gpio out",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "pin": "19",
        "set": "",
        "level": "0",
        "freq": "",
        "out": "pwm",
        "x": 660,
        "y": 820,
        "wires": []
    },
    {
        "id": "5f036011.4248c8",
        "type": "rpi-gpio out",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "pin": "21",
        "set": "",
        "level": "0",
        "freq": "",
        "out": "pwm",
        "x": 660,
        "y": 780,
        "wires": []
    },
    {
        "id": "3a344f73.a341b",
        "type": "rpi-gpio out",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "pin": "23",
        "set": "",
        "level": "0",
        "freq": "",
        "out": "pwm",
        "x": 660,
        "y": 860,
        "wires": []
    },
    {
        "id": "dcd87b79.2108e8",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "on",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 450,
        "y": 720,
        "wires": [
            [
                "5f036011.4248c8",
                "3bfc15b3.af5d12",
                "3a344f73.a341b"
            ]
        ]
    },
    {
        "id": "c334952d.1e9208",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "off",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "100",
        "payloadType": "num",
        "x": 450,
        "y": 980,
        "wires": [
            [
                "5f036011.4248c8",
                "3bfc15b3.af5d12",
                "3a344f73.a341b"
            ]
        ]
    },
    {
        "id": "70e589e9.da3a",
        "type": "comment",
        "z": "7d7b30a8.5bc2b",
        "name": "RGB control",
        "info": "",
        "x": 90,
        "y": 640,
        "wires": []
    },
    {
        "id": "1e562453.9b452c",
        "type": "function",
        "z": "7d7b30a8.5bc2b",
        "name": "adjust to rbg led",
        "func": "\nreturn {payload: (1 - msg.payload)*100};\n//invert",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 640,
        "wires": [
            [
                "5f036011.4248c8",
                "3bfc15b3.af5d12",
                "3a344f73.a341b"
            ]
        ]
    },
    {
        "id": "98176dee.b10b1",
        "type": "comment",
        "z": "7d7b30a8.5bc2b",
        "name": "Test",
        "info": "",
        "x": 770,
        "y": 460,
        "wires": []
    },
    {
        "id": "664573f7.d49c24",
        "type": "tcp in",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "server": "server",
        "host": "",
        "port": "55555",
        "datamode": "stream",
        "datatype": "buffer",
        "newline": "",
        "topic": "",
        "base64": false,
        "x": 140,
        "y": 1120,
        "wires": [
            [
                "df2da042.662a1",
                "1e562453.9b452c"
            ]
        ]
    },
    {
        "id": "3906c54c.da9f22",
        "type": "comment",
        "z": "7d7b30a8.5bc2b",
        "name": "Listen on port",
        "info": "",
        "x": 130,
        "y": 1040,
        "wires": []
    },
    {
        "id": "df2da042.662a1",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 380,
        "y": 1120,
        "wires": []
    },
    {
        "id": "20d35e60.b0f65a",
        "type": "tcp out",
        "z": "7d7b30a8.5bc2b",
        "host": "add IP",
        "port": "55555",
        "beserver": "client",
        "base64": false,
        "end": false,
        "name": "",
        "x": 370,
        "y": 1280,
        "wires": []
    },
    {
        "id": "d0ed337.b37dbd",
        "type": "tcp in",
        "z": "7d7b30a8.5bc2b",
        "name": "Server holding connections at :1025",
        "server": "server",
        "host": "",
        "port": "1025",
        "datamode": "stream",
        "datatype": "utf8",
        "newline": "\\n",
        "topic": "text",
        "base64": false,
        "x": 220,
        "y": 1560,
        "wires": [
            [
                "223f744a.5e373c",
                "337733.66a118ce"
            ]
        ]
    },
    {
        "id": "c4fce4d0.df1838",
        "type": "tcp out",
        "z": "7d7b30a8.5bc2b",
        "host": "",
        "port": "",
        "beserver": "reply",
        "base64": false,
        "end": false,
        "name": "reply: all open connections will be messaged",
        "x": 1230,
        "y": 1560,
        "wires": []
    },
    {
        "id": "94d4c7bc.6788f8",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "show incomming text at the debug tab",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 1660,
        "wires": []
    },
    {
        "id": "a6a1d927.3f5878",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "button: create a msg",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "Hello from Node-RED server.",
        "payloadType": "str",
        "x": 900,
        "y": 1480,
        "wires": [
            [
                "157cdc82.434e43"
            ]
        ]
    },
    {
        "id": "e322a7da.923938",
        "type": "debug",
        "z": "7d7b30a8.5bc2b",
        "name": "show incomming text at the debug tab",
        "active": true,
        "console": "false",
        "complete": "payload",
        "x": 410,
        "y": 2100,
        "wires": []
    },
    {
        "id": "f0eed7a2.89f068",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "button: create a msg",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "Hello from Node-RED client.",
        "payloadType": "str",
        "x": 900,
        "y": 1920,
        "wires": [
            [
                "198755f6.e33e0a"
            ]
        ]
    },
    {
        "id": "4ace7c3a.1379c4",
        "type": "tcp out",
        "z": "7d7b30a8.5bc2b",
        "host": "",
        "port": "",
        "beserver": "reply",
        "base64": false,
        "end": false,
        "name": "reply: the server will get messaged",
        "x": 1200,
        "y": 2000,
        "wires": []
    },
    {
        "id": "e6e274df.2cf878",
        "type": "tcp in",
        "z": "7d7b30a8.5bc2b",
        "name": "Node-RED Client",
        "server": "client",
        "host": "localhost",
        "port": "1025",
        "datamode": "stream",
        "datatype": "utf8",
        "newline": "\\n",
        "topic": "text2",
        "base64": false,
        "x": 160,
        "y": 2000,
        "wires": [
            [
                "43a2a0dc.3d1ff",
                "65bebabe.906914"
            ]
        ]
    },
    {
        "id": "43a2a0dc.3d1ff",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "\"CLIENT GOT:\" +",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "CLIENT GOT:\n{{payload}}",
        "x": 350,
        "y": 2060,
        "wires": [
            [
                "e322a7da.923938"
            ]
        ]
    },
    {
        "id": "223f744a.5e373c",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "\"SERVER GOT:\" +",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "SERVER GOT:\n{{payload}}",
        "x": 470,
        "y": 1620,
        "wires": [
            [
                "94d4c7bc.6788f8"
            ]
        ]
    },
    {
        "id": "337733.66a118ce",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "modify received msg to be send back",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "You were sending: {{payload}}\n",
        "x": 730,
        "y": 1560,
        "wires": [
            [
                "c4fce4d0.df1838"
            ]
        ]
    },
    {
        "id": "7d0dd2c7.0d1bac",
        "type": "comment",
        "z": "7d7b30a8.5bc2b",
        "name": "Telnet client: open your command prompt, and type: `telnet localhost 1025` and start typing",
        "info": "Telnet client: open your command prompt, and type: `telnet localhost 1025` and start typing",
        "x": 400,
        "y": 2180,
        "wires": []
    },
    {
        "id": "40767085.d36f2",
        "type": "tcp in",
        "z": "7d7b30a8.5bc2b",
        "name": "Proxy: fixing client with no NL :1026",
        "server": "server",
        "host": "",
        "port": "1026",
        "datamode": "stream",
        "datatype": "utf8",
        "newline": "",
        "topic": "text",
        "base64": false,
        "x": 220,
        "y": 1820,
        "wires": [
            [
                "6e966bfa.8ad5d4"
            ]
        ]
    },
    {
        "id": "6e966bfa.8ad5d4",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "fix incomming message with a newline",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload}}\n",
        "x": 530,
        "y": 1820,
        "wires": [
            [
                "7de967f0.d50a08"
            ]
        ]
    },
    {
        "id": "198755f6.e33e0a",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "+ newline",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload}}\n",
        "x": 1060,
        "y": 1920,
        "wires": [
            [
                "4ace7c3a.1379c4"
            ]
        ]
    },
    {
        "id": "157cdc82.434e43",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "+ newline",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload}}\n",
        "x": 1060,
        "y": 1480,
        "wires": [
            [
                "c4fce4d0.df1838"
            ]
        ]
    },
    {
        "id": "7de967f0.d50a08",
        "type": "tcp request",
        "z": "7d7b30a8.5bc2b",
        "server": "localhost",
        "port": "1025",
        "out": "time",
        "splitc": "0",
        "name": "connect the Node-RED server",
        "x": 870,
        "y": 1820,
        "wires": [
            [
                "e267c9ff.9750f8"
            ]
        ]
    },
    {
        "id": "e267c9ff.9750f8",
        "type": "tcp out",
        "z": "7d7b30a8.5bc2b",
        "host": "",
        "port": "",
        "beserver": "reply",
        "base64": false,
        "end": false,
        "name": "reply: any answer back to the client",
        "x": 1200,
        "y": 1820,
        "wires": []
    },
    {
        "id": "4a69acf7.609ab4",
        "type": "inject",
        "z": "7d7b30a8.5bc2b",
        "name": "button: open telnet to 1025 (windows)",
        "repeat": "",
        "crontab": "",
        "once": false,
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 950,
        "y": 2180,
        "wires": [
            [
                "a2c48b6b.cabd08",
                "b026565e.68d038"
            ]
        ]
    },
    {
        "id": "a2c48b6b.cabd08",
        "type": "exec",
        "z": "7d7b30a8.5bc2b",
        "command": "start",
        "addpay": false,
        "append": "telnet localhost 1025",
        "useSpawn": false,
        "timer": "",
        "name": "start telnet",
        "x": 1190,
        "y": 2180,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "b026565e.68d038",
        "type": "delay",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "pauseType": "delay",
        "timeout": "1200",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1200,
        "y": 2240,
        "wires": [
            [
                "71897a7e.1b5d34"
            ]
        ]
    },
    {
        "id": "71897a7e.1b5d34",
        "type": "exec",
        "z": "7d7b30a8.5bc2b",
        "command": "msg",
        "addpay": false,
        "append": "%username% \"start by pressing enter\"",
        "useSpawn": false,
        "timer": "",
        "name": "msg box",
        "x": 1180,
        "y": 2280,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "65bebabe.906914",
        "type": "template",
        "z": "7d7b30a8.5bc2b",
        "name": "no msg back, we do behave!",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "",
        "x": 680,
        "y": 2000,
        "wires": [
            [
                "4ace7c3a.1379c4"
            ]
        ]
    },
    {
        "id": "b304d438.985a28",
        "type": "switch",
        "z": "7d7b30a8.5bc2b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 800,
        "y": 1120,
        "wires": [
            []
        ]
    }
]